# PostgreSQL Database Acquisition Configuration
# This example shows how to read logs from a PostgreSQL database

source: database
driver: postgres
dsn: "host=localhost port=5432 user=crowdsec password=yourpassword dbname=logs sslmode=disable"

# SQL query to execute
# Use {{.timestamp}} placeholder to inject the last processed timestamp
query: "SELECT log_message, created_at, severity, application FROM application_logs WHERE created_at > '{{.timestamp}}' ORDER BY created_at ASC LIMIT 1000"

# Column containing the log message
log_column: log_message

# Column containing the timestamp (used for incremental reads)
timestamp_column: created_at

# How often to poll for new data (in tail mode)
poll_interval: 10s

# Maximum rows to fetch per query (default: 1000)
max_rows: 1000

# Additional columns to add as labels to each event
additional_columns:
  - severity
  - application

# Mode: tail (continuous polling) or cat (one-shot)
mode: tail

# Labels to apply to all events
labels:
  type: postgresql-logs

